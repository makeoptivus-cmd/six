function doPost(e) {
  try {
    const sheet = SpreadsheetApp.openById("1w0YZR380OAtRMh3DCzPGhdt3XOGXZDJmOZ3TWMLjsfg")
      .getSheetByName("Sheet1");
    const data = JSON.parse(e.postData.contents);

    sheet.appendRow([
      data.name,
      data.email,
      data.challenge,
      new Date()
    ]);

    return ContentService.createTextOutput(
      JSON.stringify({ result: "success" })
    ).setMimeType(ContentService.MimeType.JSON);

  } catch (error) {
    return ContentService.createTextOutput(
      JSON.stringify({ result: "error", error: error.message })
    ).setMimeType(ContentService.MimeType.JSON);
  }
}
